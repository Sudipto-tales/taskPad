{% extends 'layouts/app.html' %}
{% load static %}

{% block content %}
<div class="content-page">
  <div class="content">
    <div class="container-fluid">
      {% include 'layouts/partials/start-title.html' %}

      <div class="row">
        <div class="card">
          <div class="card-body">
            <a href="#" data-bs-toggle="modal" data-bs-target="#add-new-project-modal" class="btn btn-success btn-sm ms-3">Add New</a>

            <div class="tab-content mt-3">
              <div class="tab-pane show active" id="striped-rows-preview">
                <div class="table-responsive-sm">
                  <table class="table table-striped table-centered mb-0">
                    <thead>
                      <tr>
                        <th>#</th>
                        <th>Project Name</th>
                        <th>Description</th>
                        <th>Status</th>
                        <th>Created By</th>
                        
                        <th>Image Name</th>
                        <th>Due Date</th>
                        <th>Timestamp</th>
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for project in projects %}
                      <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ project.name }}</td>
                        <td>{{ project.description }}</td>
                        <td>
                          {% if project.status == 1 %}
                            <span class="badge bg-warning">Pending</span>
                          {% elif project.status == 0 %}
                            <span class="badge bg-info">Ongoing</span>
                          {% elif project.status == 2 %}
                            <span class="badge bg-success">Complete</span>
                          {% else %}
                            <span class="badge bg-secondary">Unknown</span>
                          {% endif %}
                        </td>
                        <td>{{ project.created_by }}</td>
                        <td>
                          {% if project.img_path %}
                            <img src="{{ project.img_path.url }}" alt="Project Image" width="60">
                          {% else %}
                            No image
                          {% endif %}
                        </td>
                        <td>{{ project.img_name }}</td>
                        <td>{{ project.due_date }}</td>
                        <td>{{ project.timestamp|time:"H:i" }}</td>
                        <td class="table-action">
                          <a href="#" data-bs-toggle="modal" data-bs-target="#edit-project-modal-{{ project.id }}" class="action-icon"><i class="mdi mdi-pencil"></i></a>
                          <a href="{% url 'delete_project' project.id %}" class="action-icon"><i class="mdi mdi-delete"></i></a>

                        </td>
                      </tr>

                      <!-- Include project-specific edit modal -->
                      {% include 'project/edit.html' with project=project users=users %}
                      {% endfor %}
                      
                      <tr>
                        <td colspan="10" class="text-center">No Projects found.</td>
                      </tr>
                      
                    </tbody>
                  </table>
                </div> <!-- end table-responsive -->
              </div> <!-- end preview -->
            </div> <!-- end tab-content -->
          </div> <!-- end card body -->
        </div> <!-- end card -->
      </div>
    </div>
  </div>
</div>

{% include 'project/create.html' %}

{% endblock %}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

